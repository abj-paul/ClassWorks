<!DOCTYPE html>
<html>
    <head>
        <title>Tower of Hanoi</title>
        <style>
            .disc{
                width: 290px;
                height: 50px;
                display: block;

                margin: auto;
                margin-top: 10px;

                bottom: 0px;
                position: absolute;
            }
            #frame1, #frame2, #frame3 {
                width: 300px;
                border: 3px solid black;
                float: left;
                margin-right: 10px;
                height: 250px;
                position: relative;
            }

            #guiButton button {
                width: 100px;
                margin-left:20px;
                height: 50px;
                margin-bottom: 10px;
            }
            #guiButton {
                margin-top: 300px;
            }
        </style>
    </head>
    <body> 

      
        <div id="frame1"></div>
        <div id="frame2"></div>
        <div id="frame3"></div>



        <br>
        <div id="guiButton">
            <button onclick="moveOneToTwo()">1->2</button>
            <button onclick="moveOneToThree()">1->3</button>
            <button onclick="moveTwoToOne()">2->1</button>
            <button onclick="moveTwoToThree()">2->3</button>
            <button onclick="moveThreeToOne()">3->1</button>
            <button onclick="moveThreeToTwo()">3->2</button>
        </div>

	<input type="text" id="discCountTextbox">
	<button onclick="generateDiscs(); bottomAligned('frame1'); bottomAligned('frame2'); bottomAligned('frame3');"> Generate Discs </button>
	<button onclick="clearDisc('frame1');clearDisc('frame2');clearDisc('frame3');"> Clear discs </button>
	<button onclick="checkSuccess()"> Check </button>

	<p id="resultPara"> Status: Match just started! </p>

        <script>
            function moveOneToTwo(){
                let discFrom = document.getElementById("frame1");
                let discTo = document.getElementById("frame2");

                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveOneToThree(){
                let discFrom = document.getElementById("frame1");
                let discTo = document.getElementById("frame3");

                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveTwoToOne(){
                let discFrom = document.getElementById("frame2");
                let discTo = document.getElementById("frame1");
                let removeOld = discFrom.firstElementChild;


                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
                //discFrom.removeChild(removeOld);

            }

            function moveTwoToThree(){
                let discFrom = document.getElementById("frame2");
                let discTo = document.getElementById("frame3");

                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')

            }

            function moveThreeToOne(){
                let discFrom = document.getElementById("frame3");
                let discTo = document.getElementById("frame1");

                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveThreeToTwo(){
                let discFrom = document.getElementById("frame3");
                let discTo = document.getElementById("frame2");

                discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function bottomAligned(frameId){
                let frameChildren = document.getElementById(frameId).children;

                let bottomPosition = (frameChildren.length-1)*50 + frameChildren.length*5;
                for(let i=0; i<frameChildren.length; i++){
                    frameChildren[i].style.bottom = bottomPosition + "px";
                    bottomPosition -= 55;
                    console.log("New position: "+bottomPosition+"px");
                }
            }

	  function generateRandomNumberArray(arraySize){
	      const arr = [];
	      for(let i=1; i<=arraySize; i++){
		  arr[i-1] = i;
	      }
	      
	      for (let i = arr.length -1; i > 0; i--) { //Shuffling array
		  let j = Math.floor(Math.random() * (i+1));
		  let k = arr[i];
		  arr[i] = arr[j];
		  arr[j] = k;
	      }
	      return arr;
	  }


	  function generateDiscs(){
	      let numOfDisc = document.getElementById("discCountTextbox").value;
	      console.log(numOfDisc+"were requested to be built.");

	      randNum = generateRandomNumberArray(numOfDisc);

	      for(let i=1; i<=numOfDisc; i++){
		  const newDisc = document.createElement("button");
		  newDisc.innerHTML = randNum[i-1];
		  newDisc.setAttribute("id",randNum[i-1]);
		  newDisc.setAttribute("class","disc");
		  document.getElementById("frame1").appendChild(newDisc);
	      }

	      let frameSize = 50*numOfDisc + 70 + "px";
	      document.getElementById("frame1").style.height = frameSize;
	      document.getElementById("frame2").style.height = frameSize;
	      document.getElementById("frame3").style.height = frameSize;
	  }

	  function clearDisc(frameId){
	      let disc = document.getElementById(frameId).children;
	      while(disc.length!=0) disc[0].remove();
	      console.log("After deleing all discs, we now have "+disc.length + "discs remaining in "+frameId);
	  }
	  function removeItem(item){
	      item.remove();
	  }

	  function checkSuccess(){
	      let bool1 = checkSuccessInFrame("frame1");
	      let bool2 = checkSuccessInFrame("frame2");
	      let bool3 = checkSuccessInFrame("frame3");
	      let win = bool1 || bool2 || bool3;
	      
	      const para = document.getElementById("resultPara");

	      if(win){
		  console.log("You have won!");
		  para.innerHTML = "You have won!";
	      }else{
		  console.log("You have lost!");
		  para.innerHTML = "You have lost!";
	      }
	      para.setAttribute("id","resultPara");
	      para.setAttribute("class","");
	      document.getElementsByTagName("body")[0].appendChild(para);
	  }

	  function checkSuccessInFrame(frameId){
	      let discList = document.getElementById(frameId).children;
	      let totalDisc = document.getElementById("discCountTextbox").value;

	      if(discList.length!=totalDisc) return false;
	      
	      for(let i=1; i<discList.length; i++) {
		  if(parseInt(discList[i].innerHTML) <= parseInt(discList[i-1].innerHTML)){
		      return false;
		  }
	      }

	      return true;
	  }
        </script>
    </body>
</html>
