<!DOCTYPE html>
<html>
    <head>
        <title>Tower of Hanoi</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
        <style>
			.alert{
				display: none;
			}
		h1 {
			text-align: center;
		}
	    body{
		background-color: ivory;
	    }
            .disc{
                display: block;

                margin: auto;
                margin-top: 5px;

                bottom: 0px;
                position: absolute;

		width: 100%;
		height: 50px;
		background-color: yellow;
            }
            #frame1, #frame2, #frame3 {
		margin-top: 10px;
                border: 3px solid black;
                float: left;
                margin-right: 10px;
                position: relative;
		width: 100%;
            }

	    .inputs{
		    margin-top: 30px;
		background-color: gray;
	    }

	    .inputs button {
		width: 33%;	
		margin-top: 10px;
	    }

	    #resultPara {
		padding: 10px;
		color: white;
	    }

            #guiButton button {
		    width: 100%;
		    padding: 5px;
		    margin-top:10px;
            }
            #guiButton {
                margin-top: 30px;
		display: left;
            }

        </style>
    </head>
    <body> 
	<div class="container">
		<div class="row">
			<h1> Tower of Hanoi </h1>
		</div>
		<div class="row">
			<div class="col-sm-10">
				<div class="row">
					<div class="col-sm-4"><div id="frame1" ></div></div>
       					<div class="col-sm-4"><div id="frame2"></div></div>
	        			<div class="col-sm-4"><div id="frame3"></div></div>
				</div>
			</div>


        		<div id="guiButton" class="col-sm-2">
				<div class="row">
            				<button onclick="moveOneToTwo()" class="btn">1->2</button>
            				<button onclick="moveOneToThree()">1->3</button>
            				<button onclick="moveTwoToOne()">2->1</button>
            				<button onclick="moveTwoToThree()">2->3</button>
            				<button onclick="moveThreeToOne()">3->1</button>
            				<button onclick="moveThreeToTwo()">3->2</button>
        			</div>
			</div>
		</div>

		<div class="inputs row" id="resultSegment">
			<input type="text" id="discCountTextbox" class="form-control">
			<button onclick="generateDiscs(); bottomAligned('frame1'); bottomAligned('frame2'); bottomAligned('frame3');" class="btn"> Generate Discs </button>
			<button onclick="clearDisc('frame1');clearDisc('frame2');clearDisc('frame3');" class="btn"> Clear discs </button>
			<button onclick="checkSuccess()" class="btn"> Check </button>

			<p id="resultPara"> Status: Match just started! </p>
		</div>
	</div>
	<div class="alert alert-success">
		<strong>Success!</strong> You should <a href="#" class="alert-link">read this message</a>.	
	</div>


        <script>
            function moveOneToTwo(){
                let discFrom = document.getElementById("frame1");
                let discTo = document.getElementById("frame2");

				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveOneToThree(){
                let discFrom = document.getElementById("frame1");
                let discTo = document.getElementById("frame3");

				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveTwoToOne(){
                let discFrom = document.getElementById("frame2");
                let discTo = document.getElementById("frame1");
                let removeOld = discFrom.firstElementChild;


				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
                //discFrom.removeChild(removeOld);
            }

            function moveTwoToThree(){
                let discFrom = document.getElementById("frame2");
                let discTo = document.getElementById("frame3");

				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')

            }

            function moveThreeToOne(){
                let discFrom = document.getElementById("frame3");
                let discTo = document.getElementById("frame1");

				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function moveThreeToTwo(){
                let discFrom = document.getElementById("frame3");
                let discTo = document.getElementById("frame2");
				if(checkValidMove(discFrom.firstElementChild, discTo.firstElementChild)==false) {
					const para = document.getElementById("resultPara");
					para.innerHTML = "Invalid move!";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}
                else {
					discTo.insertBefore(discFrom.firstElementChild, discTo.firstElementChild);
					const para = document.getElementById("resultPara");
					para.innerHTML = "Valid move.";
					para.setAttribute("id","resultPara");
					document.getElementById("resultSegment").appendChild(para);
				}

                bottomAligned('frame1');
                bottomAligned('frame2');
                bottomAligned('frame3')
            }

            function bottomAligned(frameId){
                let frameChildren = document.getElementById(frameId).children;

                let bottomPosition = (frameChildren.length-1)*50 + frameChildren.length*5;
                for(let i=0; i<frameChildren.length; i++){
                    frameChildren[i].style.bottom = bottomPosition + "px";
                    bottomPosition -= 55;
                    //console.log("New position: "+bottomPosition+"px");
                }
            }

	  function generateRandomNumberArray(arraySize){
	      const arr = [];
	      for(let i=1; i<=arraySize; i++){
		  arr[i-1] = i;
	      }
	      
	      for (let i = arr.length -1; i > 0; i--) { //Shuffling array
		  let j = Math.floor(Math.random() * (i+1));
		  let k = arr[i];
		  arr[i] = arr[j];
		  arr[j] = k;
	      }
	      return arr;
	  }


	  function generateDiscs(){
	      let numOfDisc = document.getElementById("discCountTextbox").value;
	      console.log(numOfDisc+"were requested to be built.");

	      randNum = generateRandomNumberArray(numOfDisc);

	      for(let i=1; i<=numOfDisc; i++){
		  const newDisc = document.createElement("button");
		  newDisc.innerHTML = randNum[i-1];
		  newDisc.setAttribute("id",randNum[i-1]);
		  newDisc.setAttribute("class","disc");
		  document.getElementById("frame1").appendChild(newDisc);
	      }

	      let frameSize = 50*numOfDisc + 70 + "px";
	      document.getElementById("frame1").style.height = frameSize;
	      document.getElementById("frame2").style.height = frameSize;
	      document.getElementById("frame3").style.height = frameSize;
	  }
	
	  function checkValidMove(from, to){
		let fromDigit = parseInt(from.innerHTML);
		if(to==null) return true;
		let toDigit = parseInt(to.innerHTML);

		console.log("Check Valid Move: "+fromDigit+"<"+toDigit);

		if(fromDigit > toDigit) {
			document.getElementsByClassName("alert")[0].style.display = "block";
			return false;
		}
		else return true;
	  }

	  function clearDisc(frameId){
	      let disc = document.getElementById(frameId).children;
	      while(disc.length!=0) disc[0].remove();
	      console.log("After deleing all discs, we now have "+disc.length + "discs remaining in "+frameId);
	  }
	  function removeItem(item){
	      item.remove();
	  }

	  function checkSuccess(){
	      let bool1 = checkSuccessInFrame("frame1");
	      let bool2 = checkSuccessInFrame("frame2");
	      let bool3 = checkSuccessInFrame("frame3");
	      let win = bool1 || bool2 || bool3;
	      
	      const para = document.getElementById("resultPara");

	      if(win){
		  console.log("You have won!");
		  para.innerHTML = "You have won!";
	      }else{
		  console.log("You have lost!");
		  para.innerHTML = "You have lost!";
	      }
	      para.setAttribute("id","resultPara");
		console.log("Win? "+win);
	      document.getElementById("resultSegment").appendChild(para);
	  }

	  function checkSuccessInFrame(frameId){
	      let discList = document.getElementById(frameId).children;
	      let totalDisc = document.getElementById("discCountTextbox").value;

	      if(discList.length!=totalDisc) return false;
	      
	      for(let i=1; i<discList.length; i++) {
		  if(parseInt(discList[i].innerHTML) <= parseInt(discList[i-1].innerHTML)){
		      return false;
		  }
	      }

	      return true;
	  }
        </script>
    </body>
</html>
